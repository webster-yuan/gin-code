# 常见问题排查指南

## 1. 端口占用问题

### 1.1 查看端口占用情况

#### Windows (PowerShell)
```powershell
# 查看指定端口占用情况
netstat -ano | findstr :8080

# 查看所有端口占用情况
netstat -ano
```

#### Linux/macOS
```bash
# 查看指定端口占用情况
lsof -i :8080

# 或使用netstat
netstat -tuln | grep 8080

# 或使用ss（推荐）
ss -tuln | grep 8080
```

### 1.2 终止占用端口的进程

#### Windows (PowerShell)
```powershell
# 终止指定PID的进程
Stop-Process -Id <进程ID> -Force

# 或使用taskkill
Taskkill /PID <进程ID> /F
```

#### Linux/macOS
```bash
# 终止指定PID的进程
kill -9 <进程ID>

# 或使用lsof直接终止
lsof -ti :8080 | xargs kill -9
```

## 2. 服务启动失败问题

### 2.1 查看服务日志

#### Windows (PowerShell)
```powershell
# 查看Windows事件日志
Get-EventLog -LogName Application -Newest 50

# 查看应用程序输出（如果服务支持）
Get-Content -Path "C:\path\to\logfile.log" -Tail 100
```

#### Linux/macOS
```bash
# 查看系统日志
tail -n 100 /var/log/syslog

# 查看应用程序日志
tail -n 100 /path/to/logfile.log

# 查看journalctl日志（适用于systemd服务）
journalctl -u <service-name> -n 100
```

### 2.2 检查进程状态

#### Windows (PowerShell)
```powershell
# 查看所有进程
Get-Process

# 查看指定名称的进程
Get-Process -Name <process-name>
```

#### Linux/macOS
```bash
# 查看所有进程
ps aux

# 查看指定名称的进程
ps aux | grep <process-name>

# 查看进程树
pstree
```

## 3. 网络连接问题

### 3.1 检查网络连通性

#### Windows/Linux/macOS
```bash
# 检查网络连通性
ping <hostname/ip>

# 检查特定端口连通性

# Windows
Test-NetConnection -ComputerName <hostname/ip> -Port 8080

# Linux/macOS
nc -z <hostname/ip> 8080

# 或使用telnet
telnet <hostname/ip> 8080
```

### 3.2 查看网络接口信息

#### Windows (PowerShell)
```powershell
# 查看网络接口信息
Get-NetAdapter

# 查看IP配置
Get-NetIPConfiguration
```

#### Linux/macOS
```bash
# 查看网络接口信息
ifconfig

# 或使用ip命令（Linux推荐）
ip addr

# 查看路由表
route -n
```

## 4. 环境配置问题

### 4.1 查看环境变量

#### Windows (PowerShell)
```powershell
# 查看所有环境变量
Get-ChildItem Env:

# 查看指定环境变量
$env:<variable-name>
```

#### Linux/macOS
```bash
# 查看所有环境变量
env

# 查看指定环境变量
echo $<variable-name>
```

### 4.2 检查文件权限

#### Windows (PowerShell)
```powershell
# 查看文件权限
Get-Acl -Path "C:\path\to\file" | Format-List

# 查看目录权限
Get-Acl -Path "C:\path\to\directory" | Format-List
```

#### Linux/macOS
```bash
# 查看文件权限
ls -l <file-path>

# 查看目录权限
ls -ld <directory-path>

# 递归查看目录权限
ls -laR <directory-path>
```

## 5. 应用程序问题

### 5.1 查看应用程序依赖

#### Windows (PowerShell)
```powershell
# 查看Go模块依赖
cd <project-path>
go mod tidy
```

#### Linux/macOS
```bash
# 查看Go模块依赖
cd <project-path>
go mod tidy

# 查看其他语言依赖（如Node.js）
npm list
```

### 5.2 检查代码语法错误

#### Windows/Linux/macOS
```bash
# 检查Go代码语法
go build

# 检查Go代码格式
go fmt ./...

# 检查Go代码静态分析
go vet ./...
```

## 6. 数据库连接问题

### 6.1 检查数据库连接状态

#### SQLite（跨平台）
```bash
# 查看SQLite数据库状态
sqlite3 <database-file> ".tables"
```

#### MySQL
```bash
# 检查MySQL连接
mysql -u <username> -p -h <hostname> -P <port>

# 查看MySQL进程（Linux）
ps aux | grep mysqld
```

#### PostgreSQL
```bash
# 检查PostgreSQL连接
psql -U <username> -h <hostname> -p <port> <database-name>

# 查看PostgreSQL进程（Linux）
ps aux | grep postgres
```

## 7. 排查思路

### 7.1 基本排查步骤
1. **查看错误日志**：首先查看应用程序和系统日志
2. **检查依赖**：确认所有依赖都已正确安装
3. **验证配置**：检查配置文件是否正确
4. **测试组件**：逐一测试各个组件的功能
5. **隔离问题**：通过排除法确定问题所在

### 7.2 常见错误类型
- **配置错误**：配置文件格式错误或参数设置不当
- **依赖缺失**：缺少必要的依赖包或版本不兼容
- **权限问题**：文件或目录权限不足
- **资源占用**：端口、内存或CPU资源耗尽
- **网络问题**：网络连接失败或超时

## 8. 工具推荐

### 8.1 Windows工具
- **Process Explorer**：高级进程管理工具
- **Wireshark**：网络数据包分析工具
- **Resource Monitor**：系统资源监控工具

### 8.2 Linux工具
- **htop**：高级进程监控工具
- **tcpdump**：网络数据包捕获工具
- **journalctl**：系统日志管理工具
- **strace**：系统调用跟踪工具

### 8.3 跨平台工具
- **Postman**：API测试工具
- **VS Code**：代码编辑器和调试工具
- **Git**：版本控制工具

## 更新记录

- 2026-01-17：初始版本，包含端口占用、服务启动失败、网络问题等排查指南